# V8 引擎

## 前言

V8引擎对于大多数前端开发人员来说非常熟悉了。它师出名门，是 Google 公司开发的高性能引擎。大名鼎鼎的 Node.js 就是基于 V8 引擎开发的，对前端开发比较友好的 Chrome 浏览器也有它的影子，甚至还实现了前端的 ES 规范和 WebAssembly 规范。有了它可以让我们在各种平台上运行 javascript 代码。

## V8 引擎的诞生

V8 是谷歌开源的一个基于C++语言开发的JavaScript引擎，可以实现ECMA-262中规定的 ECMAScript，其被用于谷歌浏览器chrome，安卓浏览器，node.js等大型项目当中，V8 引擎可以独立运行不依赖于其他环境，也可以嵌入任何的 C++ 应用当中使用。

 V8 最早被开发用以嵌入到 Google 的开源浏览器 Chrome 中，第一个版本随着第一版Chrome于 2008 年 9 月 2 日发布。但是 V8 是一个可以独立运行的模块，完全可以嵌入到任何 C ++应用程序中。著名的 Node.js( 一个异步的服务器框架，可以在服务端使用 JavaScript 写出高效的网络服务器 ) 就是基于 V8 引擎的，Couchbase, MongoDB 也使用了 V8 引擎。

V8 会编译 / 执行 JavaScript 代码，管理内存，负责垃圾回收，与宿主语言的交互等。通过暴露宿主对象 ( 变量，函数等 ) 到 JavaScript，JavaScript 可以访问宿主环境中的对象，并在脚本中完成对宿主对象的操作。

## V8 的工作流程

V8 将JavaScript代码进行编译，生成抽象语法树（AST），对作用域进行分析，分辨出局部变量或全局变量，再通过JIT技术将语法树直接转换成原生代码，没有经过字节码的编译，节省了编译时间，得到了不是最优的代码，其后通过数据分析器挑选使用频率高的代码进行优化，若优化后的效果不如之前的话就进行优化回滚。

V8 是一个非常复杂的项目，有超过 100 万行 C++代码。它由许多子模块构成，其中这 4 个模块是最重要的：
Parser 将 JS 源码转换为 AST，然后 Ignition 将 AST 转换为 Bytecode，最后 TurboFan 将 Bytecode 转换为经过优化的 Machine Code(实际上是汇编代码)。

> 浅读 V8 ——强大的JavaScript引擎: <https://www.jianshu.com/p/332c15fd7c7d>
> js中 v8 引擎的详解: <https://www.jianshu.com/p/0ab973761b8a>
> 认识 V8 引擎: <https://zhuanlan.zhihu.com/p/27628685>
> 浏览器是如何工作的：Chrome V8 让你更懂 JavaScript: <https://segmentfault.com/a/1190000037435824>
